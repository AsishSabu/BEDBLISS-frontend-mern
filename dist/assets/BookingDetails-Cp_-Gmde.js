import{r as x,j as e,s as S,l as C,u as D,U as g}from"./index-BbR1353G.js";import{a as f,s as i}from"./hoist-non-react-statics.cjs-BToLjH0z.js";import{u as $}from"./Notifications-DoaGR5xu.js";import{u as A}from"./NotificationHook-DhwK8gV6.js";import"./Pagination-BytGtE1z.js";import"./tslib.es6-DuO2G4rp.js";import"./clsx-B-dksMZM.js";const E=({isOpen:s,onClose:a,onConfirm:p})=>{const[l,r]=x.useState(""),d=()=>{p(l),a()};return s?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cancel Booking"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for cancellation"}),e.jsxs("select",{title:"options",value:l,onChange:b=>r(b.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reason"}),e.jsx("option",{value:"Overbooking",children:"Overbooking"}),e.jsx("option",{value:"Payment Issues",children:"Payment Issues"}),e.jsx("option",{value:"Maintenance Issues",children:"Maintenance Issues"}),e.jsx("option",{value:"Unavailability of Specific Amenities",children:"Unavailability of Specific Amenities"}),e.jsx("option",{value:"Exclusive Event",children:"Exclusive Event"}),e.jsx("option",{value:"Local Regulations",children:"Local Regulations"}),e.jsx("option",{value:"VIP Guest Priority",children:"VIP Guest Priority"}),e.jsx("option",{value:"Operational Constraints",children:"Operational Constraints"}),e.jsx("option",{value:"Unpaid Previous Stays",children:"Unpaid Previous Stays"})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:a,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2",children:"Close"}),e.jsx("button",{onClick:d,className:"bg-red-500 text-white px-4 py-2 rounded",children:"Confirm Cancellation"})]})]})}):null},y=s=>new Date(s).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),L=()=>{var k;const[s,a]=x.useState(null),[p,l]=x.useState(!1),r=S(t=>t.userSlice),{sendNotification:d}=A(),{id:b}=C(),v=D(),{data:c,isError:j}=$(`${g}/bookingDetails/${b}`);if(x.useEffect(()=>{console.log(c,"data......."),c&&a(c.bookings)},[c]),j)return console.error("Error fetching booking:",j),e.jsx("div",{children:"Error fetching booking details."});if(!c)return e.jsx("div",{children:"Loading..."});const N=async t=>{if(s)try{const o=await f.patch(`${g}/booking/cancel/${s.bookingId}`,{reason:t,status:"rejected"},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),m=`${o.data.booking.hotelId.name} booking rejected by ${r.name}`,u=`/user/profile/bookingDetails/${o.data.booking._id}`,n=o.data.booking.userId;d(m,u,r,n,3),a(h=>({...h,bookingStatus:o.data.booking.bookingStatus??(h==null?void 0:h.bookingStatus)})),i("Booking Rejected successfully","success")}catch(o){console.error("Error rejecting booking:",o),i("Oops! Something went wrong","error")}},w=async()=>{if(s)try{const t=await f.patch(`${g}/booking/cancel/${s.bookingId}`,{status:"cancelled"},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),o=`${t.data.booking.hotelId.name} hotel cancellation accepted by ${r.name}`,m=`/user/profile/bookingDetails/${t.data.booking._id}`,u=t.data.booking.userId;d(o,m,r,u,5),a(n=>({...n,bookingStatus:t.data.booking.bookingStatus??(n==null?void 0:n.bookingStatus)})),i("Booking cancellation accepted successfully","success")}catch(t){console.error("Error in accept cancellation of booking:",t),i("Oops! Something went wrong","error")}},I=async()=>{if(s)try{const t=await f.patch(`${g}/booking/update/${s.bookingId}`,{status:"booked"},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),o=`${t.data.booking.hotelId.name} booking accepted by ${r.name}`,m=`/user/profile/bookingDetails/${t.data.booking._id}`,u=t.data.booking.userId;d(o,m,r,u,4),a(n=>({...n,bookingStatus:t.data.booking.bookingStatus??(n==null?void 0:n.bookingStatus)})),i("Booking successfully Approved","success")}catch(t){console.error("Error approving booking:",t),i("Oops! Something went wrong","error")}};return e.jsxs("div",{className:"w-screen h-fit overflow-hidden flex justify-center",children:[e.jsx("div",{className:"bg-varWhite min-h-screen p-4",children:e.jsxs("div",{className:"mx-auto bg-white shadow-lg rounded-lg p-6",children:[e.jsx("h1",{className:"text-2xl text-center font-semibold mb-4",children:"Booking Details"}),s&&e.jsxs("div",{className:"mb-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"items-center rounded-lg mb-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm  text-gray-600 mb-1",children:"Check-in-Date"}),e.jsx("p",{className:"text-xl font-bold text-gray-600",children:y(s.checkInDate)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm  text-gray-600 mb-1",children:"Check-out-Date"}),e.jsx("p",{className:"text-xl font-bold text-gray-600",children:y(s.checkOutDate)})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx("p",{className:"font-bold  text-varBlue mb-1 mt-2",children:"Booking Details"}),e.jsxs("h2",{className:" text-sm font-semibold  mb-2 ",children:["BOOKING ID :",e.jsx("span",{className:"font-normal mx-2",children:s.bookingId})]}),e.jsxs("p",{className:"text-sm font-semibold mb-2",children:["Booking Status:",e.jsx("span",{className:"font-normal mx-2",children:s.bookingStatus})]}),e.jsxs("p",{className:" text-sm font-semibold",children:["Details: ",s.maxAdults&&s.maxAdults+" Adult",",",s.maxChildren&&s.maxChildren+" Children","--",s.totalDays+" nights",",",s.totalRooms+" rooms"]})]}),e.jsxs("p",{className:"text-sm font-semibold mb-2",children:["Payment Method: ",e.jsx("span",{className:"font-normal mx-2",children:s.paymentMethod})]}),e.jsxs("p",{className:" text-lg  mb-2",children:["Amount: ",s.price]})]}),e.jsxs("div",{className:"border rounded-lg p-4 my-3",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"User Details"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("p",{children:["Name: ",s.firstName," ",s.lastName]}),e.jsxs("p",{children:["Email: ",s.email]}),e.jsxs("p",{children:["Phone: ",s.phoneNumber]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 my-3",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"Stay Address"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("p",{children:["Street: ",s.hotelId.address.streetAddress]}),e.jsxs("p",{children:["City: ",s.hotelId.address.city]}),e.jsxs("p",{children:["LandMark: ",s.hotelId.address.landMark]}),e.jsxs("p",{children:["District: ",s.hotelId.address.district]}),e.jsxs("p",{children:["Pincode: ",s.hotelId.address.pincode]}),e.jsxs("p",{children:["Country: ",s.hotelId.address.country]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"p-5 text-black rounded-lg",children:[e.jsx("img",{alt:"image",src:(k=s==null?void 0:s.hotelId)==null?void 0:k.imageUrls[0],className:"p-3 h-64 w-full"}),e.jsx("h2",{className:"px-3 text-xl text-right font-medium mb-2",children:s.hotelId.name}),e.jsx("h2",{className:"px-3 text-base text-right font-medium mb-2",children:s.hotelId.destination})]}),e.jsxs("div",{className:"border rounded-lg p-4 my-3",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"Property Rules"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:s.hotelId.propertyRules.map((t,o)=>e.jsx("p",{children:t},o))})]})]})]}),e.jsxs("div",{className:"flex justify-between mx-40",children:[e.jsx("button",{onClick:()=>v(-1),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-green-400 to-blue-600 group-hover:from-green-400 group-hover:to-blue-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-green-200 dark:focus:ring-green-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Go Back"})}),s&&s.bookingStatus==="pending"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("button",{onClick:()=>I(),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-400 to-pink-600 group-hover:from-red-400 group-hover:to-pink-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-red-200 dark:focus:ring-red-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Accept Booking"})}),e.jsx("button",{onClick:()=>l(!0),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-400 to-pink-600 group-hover:from-red-400 group-hover:to-pink-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-red-200 dark:focus:ring-red-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Reject Booking"})})]}),s&&s.bookingStatus==="cancel requested"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("button",{onClick:()=>w(),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-400 to-pink-600 group-hover:from-red-400 group-hover:to-pink-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-red-200 dark:focus:ring-red-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Approve cancel"})})]})]})]})}),e.jsx(E,{isOpen:p,onClose:()=>l(!1),onConfirm:N})]})};export{L as default};

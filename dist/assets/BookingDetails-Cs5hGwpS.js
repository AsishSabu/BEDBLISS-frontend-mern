import{r as x,j as e,s as I,l as S,u as C,U as h}from"./index-C0JB0cT-.js";import{a as f,s as i}from"./hoist-non-react-statics.cjs-CxxjioJb.js";import{u as D}from"./Notifications-BtANmxaB.js";import{u as $}from"./NotificationHook-CKFK8QD4.js";import"./index-Cd8CbeYN.js";import"./clsx-B-dksMZM.js";const E=({isOpen:t,onClose:a,onConfirm:p})=>{const[l,r]=x.useState(""),c=()=>{p(l),a()};return t?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cancel Booking"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for cancellation"}),e.jsxs("select",{title:"options",value:l,onChange:b=>r(b.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reason"}),e.jsx("option",{value:"Overbooking",children:"Overbooking"}),e.jsx("option",{value:"Payment Issues",children:"Payment Issues"}),e.jsx("option",{value:"Maintenance Issues",children:"Maintenance Issues"}),e.jsx("option",{value:"Unavailability of Specific Amenities",children:"Unavailability of Specific Amenities"}),e.jsx("option",{value:"Exclusive Event",children:"Exclusive Event"}),e.jsx("option",{value:"Local Regulations",children:"Local Regulations"}),e.jsx("option",{value:"VIP Guest Priority",children:"VIP Guest Priority"}),e.jsx("option",{value:"Operational Constraints",children:"Operational Constraints"}),e.jsx("option",{value:"Unpaid Previous Stays",children:"Unpaid Previous Stays"})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:a,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2",children:"Close"}),e.jsx("button",{onClick:c,className:"bg-red-500 text-white px-4 py-2 rounded",children:"Confirm Cancellation"})]})]})}):null},_=()=>{var k;const[t,a]=x.useState(null),[p,l]=x.useState(!1),r=I(s=>s.userSlice),{sendNotification:c}=$(),{id:b}=S(),y=C(),{data:d,isError:j}=D(`${h}/bookingDetails/${b}`);if(x.useEffect(()=>{console.log(d,"data......."),d&&a(d.bookings)},[d]),j)return console.error("Error fetching booking:",j),e.jsx("div",{children:"Error fetching booking details."});if(!d)return e.jsx("div",{children:"Loading..."});const v=async s=>{if(t)try{const o=await f.patch(`${h}/booking/cancel/${t.bookingId}`,{reason:s,status:"rejected"},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),u=`${o.data.booking.hotelId.name} booking rejected by ${r.name}`,g=`/user/profile/bookingDetails/${o.data.booking._id}`,n=o.data.booking.userId;c(u,g,r,n,3),a(m=>({...m,bookingStatus:o.data.booking.bookingStatus??(m==null?void 0:m.bookingStatus)})),i("Booking Rejected successfully","success")}catch(o){console.error("Error rejecting booking:",o),i("Oops! Something went wrong","error")}},N=async()=>{if(t)try{const s=await f.patch(`${h}/booking/cancel/${t.bookingId}`,{status:"cancelled"},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),o=`${s.data.booking.hotelId.name} hotel cancellation accepted by ${r.name}`,u=`/user/profile/bookingDetails/${s.data.booking._id}`,g=s.data.booking.userId;c(o,u,r,g,5),a(n=>({...n,bookingStatus:s.data.booking.bookingStatus??(n==null?void 0:n.bookingStatus)})),i("Booking cancellation accepted successfully","success")}catch(s){console.error("Error in accept cancellation of booking:",s),i("Oops! Something went wrong","error")}},w=async()=>{if(t)try{const s=await f.patch(`${h}/booking/update/${t.bookingId}`,{status:"booked"},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),o=`${s.data.booking.hotelId.name} booking accepted by ${r.name}`,u=`/user/profile/bookingDetails/${s.data.booking._id}`,g=s.data.booking.userId;c(o,u,r,g,4),a(n=>({...n,bookingStatus:s.data.booking.bookingStatus??(n==null?void 0:n.bookingStatus)})),i("Booking successfully Approved","success")}catch(s){console.error("Error approving booking:",s),i("Oops! Something went wrong","error")}};return e.jsxs("div",{className:"w-screen h-fit overflow-hidden flex justify-center",children:[e.jsx("div",{className:"bg-varWhite min-h-screen p-4",children:e.jsxs("div",{className:"mx-auto bg-white shadow-lg rounded-lg p-6",children:[e.jsx("h1",{className:"text-2xl text-center font-semibold mb-4",children:"Booking Details"}),t&&e.jsxs("div",{className:"mb-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"items-center rounded-lg mb-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h2",{className:"text-lg font-medium mb-2",children:["BOOKING ID : ",t.bookingId]}),e.jsxs("p",{className:"text-base text-green-500 mb-2",children:["Booking Status: ",t.bookingStatus]}),e.jsxs("p",{className:"text-base text-red-500 mb-2",children:["Payment Method: ",t.paymentMethod]}),e.jsxs("p",{className:" text-lg  mb-2",children:["Amount: ",t.price]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-600 mb-1",children:"Check-in-Date"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.checkInDate?new Date(t.checkInDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-600 mb-1",children:"Check-out-Date"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.checkOutDate?new Date(t.checkOutDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 my-3",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"User Details"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("p",{children:["Name: ",t.firstName," ",t.lastName]}),e.jsxs("p",{children:["Email: ",t.email]}),e.jsxs("p",{children:["Phone: ",t.phoneNumber]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 my-3",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"Stay Address"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("p",{children:["Street: ",t.hotelId.address.streetAddress]}),e.jsxs("p",{children:["City: ",t.hotelId.address.city]}),e.jsxs("p",{children:["LandMark: ",t.hotelId.address.landMark]}),e.jsxs("p",{children:["District: ",t.hotelId.address.district]}),e.jsxs("p",{children:["Pincode: ",t.hotelId.address.pincode]}),e.jsxs("p",{children:["Country: ",t.hotelId.address.country]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"p-5 text-black rounded-lg",children:[e.jsx("img",{alt:"image",src:(k=t==null?void 0:t.hotelId)==null?void 0:k.imageUrls[0],className:"p-3 h-64 w-full"}),e.jsx("h2",{className:"px-3 text-xl text-right font-medium mb-2",children:t.hotelId.name}),e.jsx("h2",{className:"px-3 text-base text-right font-medium mb-2",children:t.hotelId.destination})]}),e.jsxs("div",{className:"border rounded-lg p-4 my-3",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"Property Rules"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:t.hotelId.propertyRules.map((s,o)=>e.jsx("p",{children:s},o))})]})]})]}),e.jsxs("div",{className:"flex justify-between mx-40",children:[e.jsx("button",{onClick:()=>y(-1),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-green-400 to-blue-600 group-hover:from-green-400 group-hover:to-blue-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-green-200 dark:focus:ring-green-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Go Back"})}),t&&t.bookingStatus==="pending"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("button",{onClick:()=>w(),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-400 to-pink-600 group-hover:from-red-400 group-hover:to-pink-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-red-200 dark:focus:ring-red-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Accept Booking"})}),e.jsx("button",{onClick:()=>l(!0),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-400 to-pink-600 group-hover:from-red-400 group-hover:to-pink-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-red-200 dark:focus:ring-red-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Reject Booking"})})]}),t&&t.bookingStatus==="cancel requested"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("button",{onClick:()=>N(),className:"relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-400 to-pink-600 group-hover:from-red-400 group-hover:to-pink-600 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-red-200 dark:focus:ring-red-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:"Approve cancel"})})]})]})]})}),e.jsx(E,{isOpen:p,onClose:()=>l(!1),onConfirm:v})]})};export{_ as default};
